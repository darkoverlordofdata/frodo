(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// Generated by CoffeeScript 1.7.1
var DEBUG_MODE, currentlySelectedPlaceElement, displayFriends, displayMealList, displayPlaces, displaySelectedMeal, handleGenericError, handleOGSuccess, handlePublishOGError, handleStatusChange, logResponse, meals, menuHandler, myFriends, nearbyPlaces, publishOGAction, reauthorizeForPublishPermissions, selectedFriends, selectedMealIndex, selectedPlaceID, selectedPlaceIndex, showPublishConfirmation, updateUserInfo;

DEBUG_MODE = false;

selectedMealIndex = -1;

selectedPlaceIndex = -1;

selectedPlaceID = null;

nearbyPlaces = null;

myFriends = null;

currentlySelectedPlaceElement = null;

selectedFriends = {};

meals = [
  {
    id: "cheeseburger",
    title: "Cheeseburger",
    url: "http://nodescrumptious.azurewebsites.net/meals/cheeseburger"
  }, {
    id: "chinese",
    title: "Chinese",
    url: "http://nodescrumptious.azurewebsites.net/meals/chinese"
  }, {
    id: "french",
    title: "French",
    url: "http://nodescrumptious.azurewebsites.net/meals/french"
  }, {
    id: "hotdog",
    title: "Hot Dog",
    url: "http://nodescrumptious.azurewebsites.net/meals/hotdog"
  }, {
    id: "indian",
    title: "Indian",
    url: "http://nodescrumptious.azurewebsites.net/meals/indian"
  }, {
    id: "italian",
    title: "Italian",
    url: "http://nodescrumptious.azurewebsites.net/meals/italian"
  }, {
    id: "pizza",
    title: "Pizza",
    url: "http://nodescrumptious.azurewebsites.net/meals/pizza"
  }
];

logResponse = function(response) {
  if (typeof console !== "undefined") {
    return console.log("The response was", response);
  }
};

handleStatusChange = function(response) {
  if (response.authResponse) {
    logResponse(response);
    window.location.hash = "#menu";
    return updateUserInfo(response);
  } else {
    return window.location.hash = "#login";
  }
};

updateUserInfo = function(response) {
  return FB.api("/me", {
    fields: "name,first_name,picture"
  }, function(response) {
    var output;
    logResponse(response);
    output = "";
    output += "<img src=\"" + response.picture.data.url + "\" width=\"25\" height=\"25\"></img>";
    output += " " + response.first_name;
    return $("#user-identity").html(output);
  });
};

handleOGSuccess = function() {
  logResponse("[handleOGSuccess] done.");
  showPublishConfirmation();
  selectedMealIndex = -1;
  selectedPlaceIndex = -1;
  selectedPlaceID = null;
  currentlySelectedPlaceElement = null;
  selectedFriends = {};
  $("#select-meal").html("Select one");
  $("#select-location").html("Select one");
  $("#select-friends").html("Select friends");
  return $("#announce").addClass("ui-disabled");
};

handleGenericError = function(e) {
  return logResponse("Error ..." + JSON.stringify(e));
};

handlePublishOGError = function(e) {
  var errorCode;
  logResponse("Error publishing ..." + JSON.stringify(e));
  errorCode = e.code;
  logResponse("Error code ..." + errorCode);
  if (errorCode === "200") {
    return reauthorizeForPublishPermissions();
  }
};

reauthorizeForPublishPermissions = function() {
  logResponse("[reauthorizeForPublishPermissions] asking for additional permissions.");
  return FB.login((function(response) {
    if (!response || response.error) {
      return handleGenericError(response.error);
    } else {
      return publishOGAction(response);
    }
  }), {
    scope: "publish_actions"
  });
};

publishOGAction = function(response) {
  var errorHandler, friendIDArrays, friendId, params;
  errorHandler = null;
  if (!response || response.error) {
    errorHandler = handlePublishOGError;
  } else {
    errorHandler = handleGenericError;
  }
  logResponse("Publishing action...");
  params = {
    meal: meals[selectedMealIndex].url
  };
  if (selectedPlaceID) {
    params.place = selectedPlaceID;
  }
  friendIDArrays = [];
  for (friendId in selectedFriends) {
    if (selectedFriends.hasOwnProperty(friendId)) {
      friendIDArrays.push(friendId);
    }
  }
  if (friendIDArrays.length > 0) {
    params.tags = friendIDArrays.join();
  }
  logResponse("Publish params " + JSON.stringify(params));
  return $.ajax({
    url: "/announce",
    type: "post",
    data: params
  }).success(function(result) {
    return handleOGSuccess(result);
  }).error(function(xhr) {
    try {
      response = JSON.parse(xhr.responseText);
      if (response.error && response.redirectUri) {
        return window.location = response.redirectUri;
      }
    } catch (_error) {}
  });
};

showPublishConfirmation = function() {
  $("#confirmation").append("<p>Publish successful</p>");
  return $("#confirmation").fadeOut(3000, function() {
    $("#confirmation").html("");
    return $("#confirmation").show();
  });
};

displayMealList = function() {
  var output, tmpl;
  logResponse("[displayMealList] displaying meal list.");
  tmpl = $("#meal_list_tmpl").html();
  output = Mustache.to_html(tmpl, meals);
  return $("#meal-list").html(output).listview("refresh");
};

displaySelectedMeal = function() {
  var meal, output, tmpl;
  logResponse("[displaySelectedMeal] displaying selected meal.");
  meal = meals[selectedMealIndex];
  tmpl = $("#selected_meal_tmpl").html();
  output = Mustache.to_html(tmpl, meal);
  return $("#selected_meal").html(output);
};

window.getNearby = function() {
  if (nearbyPlaces) {
    return;
  }
  logResponse("[getNearby] get nearby data.");
  return navigator.geolocation.getCurrentPosition(function(location) {
    logResponse(location);
    return $.ajax({
      url: "/search",
      data: {
        type: "place",
        q: "restaurant",
        center: location.coords.latitude + "," + location.coords.longitude,
        distance: 1000,
        fields: "id,name,picture"
      }
    }).success(function(response) {
      nearbyPlaces = response.data;
      logResponse(nearbyPlaces);
      return displayPlaces(nearbyPlaces);
    }).error(function(err) {
      return logResponse("Error fetching nearby place data.");
    });
  });
};

displayPlaces = function(places) {
  var output, tmpl;
  logResponse("[displayPlaces] displaying nearby list.");
  tmpl = $("#places_list_tmpl").html();
  output = Mustache.to_html(tmpl, places);
  return $("#places-list").html(output).listview("refresh");
};

window.getFriends = function() {
  if (myFriends) {
    return;
  }
  logResponse("[getFriends] get friend data.");
  return $.ajax({
    url: "/friends"
  }).success(function(response) {
    myFriends = response.data;
    logResponse(myFriends);
    return displayFriends(myFriends);
  }).error(function(err) {
    return logResponse("Error fetching friend data.");
  });
};

displayFriends = function(friends) {
  var output, tmpl;
  logResponse("[displayFriends] displaying friend list.");
  tmpl = $("#friends_list_tmpl").html();
  output = Mustache.to_html(tmpl, friends);
  return $("#friends-list").html(output).listview("refresh");
};

$(function() {
  $("#logout").click(function() {
    window.location = "/logout";
    return false;
  });
  $("#announce").click(function() {
    return publishOGAction(null);
  });
  $("#meal-list").on("click", "li", function() {
    selectedMealIndex = $(this).index();
    logResponse("Link in meal listview clicked... " + selectedMealIndex);
    return displaySelectedMeal();
  });
  $("#detail-meal-select").click(function() {
    $("#announce").removeClass("ui-disabled");
    return $("#select-meal").html(meals[selectedMealIndex].title);
  });
  $("#places-list").on("click", "li", function() {
    var selectionId, selectionStatus;
    selectionId = $(this).attr("data-name");
    logResponse("Selected place " + selectionId);
    selectionStatus = $(this).attr("data-icon");
    if (selectionStatus === "false") {
      if (currentlySelectedPlaceElement) {
        currentlySelectedPlaceElement.buttonMarkup({
          icon: false
        });
      }
      $(this).buttonMarkup({
        icon: "check"
      });
      selectedPlaceID = selectionId;
      selectedPlaceIndex = $(this).index();
      $("#select-location").html(nearbyPlaces[selectedPlaceIndex].name);
      return currentlySelectedPlaceElement = $(this);
    } else {
      $(this).buttonMarkup({
        icon: false
      });
      selectedPlaceID = null;
      selectedPlaceIndex = -1;
      return $("#select-location").html("Select one");
    }
  });
  return $("#friends-list").on("click", "li", function() {
    var friendId, friendNameArray, otherFriends, selectedIndex, selectionId, selectionStatus;
    selectionId = $(this).attr("data-name");
    logResponse("Selected friend " + selectionId);
    selectedIndex = $(this).index();
    selectionStatus = $(this).attr("data-icon");
    if (selectionStatus === "false") {
      $(this).buttonMarkup({
        icon: "check"
      });
      selectedFriends[selectionId] = myFriends[selectedIndex].name;
    } else {
      $(this).buttonMarkup({
        icon: false
      });
      delete selectedFriends[selectionId];
    }
    friendNameArray = [];
    for (friendId in selectedFriends) {
      if (selectedFriends.hasOwnProperty(friendId)) {
        friendNameArray.push(selectedFriends[friendId]);
      }
    }
    if (friendNameArray.length > 2) {
      otherFriends = friendNameArray.length - 1;
      $("#select-friends").html(friendNameArray[0] + " and " + otherFriends + " others");
    } else if (friendNameArray.length === 2) {
      $("#select-friends").html(friendNameArray[0] + " and " + friendNameArray[1]);
    } else if (friendNameArray.length === 1) {
      $("#select-friends").html(friendNameArray[0]);
    } else {
      $("#select-friends").html("Select friends");
    }
    return logResponse("Current select friends list: " + selectedFriends);
  });
});

$(document).delegate("#meals", "pageinit", function() {
  return displayMealList();
});

$("body").bind("hideOpenMenus", function() {
  return $("ul:jqmData(role='menu')").find("li > ul").hide();
});

menuHandler = function(e) {
  $("body").trigger("hideOpenMenus");
  $(this).find("li > ul").show();
  return e.stopPropagation();
};

$("ul:jqmData(role='menu') li > ul li").click(function(e) {
  $("body").trigger("hideOpenMenus");
  return e.stopPropagation();
});

$("body").delegate("ul:jqmData(role='menu')", "click", menuHandler);

$("body").click(function(e) {
  return $("body").trigger("hideOpenMenus");
});

},{}]},{},[1])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvaG9tZS9icnVjZS9PcGVuU2hpZnQvZnJvZG8vdG1wL3NjcnVtcHRpb3VzL2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNy4xXG52YXIgREVCVUdfTU9ERSwgY3VycmVudGx5U2VsZWN0ZWRQbGFjZUVsZW1lbnQsIGRpc3BsYXlGcmllbmRzLCBkaXNwbGF5TWVhbExpc3QsIGRpc3BsYXlQbGFjZXMsIGRpc3BsYXlTZWxlY3RlZE1lYWwsIGhhbmRsZUdlbmVyaWNFcnJvciwgaGFuZGxlT0dTdWNjZXNzLCBoYW5kbGVQdWJsaXNoT0dFcnJvciwgaGFuZGxlU3RhdHVzQ2hhbmdlLCBsb2dSZXNwb25zZSwgbWVhbHMsIG1lbnVIYW5kbGVyLCBteUZyaWVuZHMsIG5lYXJieVBsYWNlcywgcHVibGlzaE9HQWN0aW9uLCByZWF1dGhvcml6ZUZvclB1Ymxpc2hQZXJtaXNzaW9ucywgc2VsZWN0ZWRGcmllbmRzLCBzZWxlY3RlZE1lYWxJbmRleCwgc2VsZWN0ZWRQbGFjZUlELCBzZWxlY3RlZFBsYWNlSW5kZXgsIHNob3dQdWJsaXNoQ29uZmlybWF0aW9uLCB1cGRhdGVVc2VySW5mbztcblxuREVCVUdfTU9ERSA9IGZhbHNlO1xuXG5zZWxlY3RlZE1lYWxJbmRleCA9IC0xO1xuXG5zZWxlY3RlZFBsYWNlSW5kZXggPSAtMTtcblxuc2VsZWN0ZWRQbGFjZUlEID0gbnVsbDtcblxubmVhcmJ5UGxhY2VzID0gbnVsbDtcblxubXlGcmllbmRzID0gbnVsbDtcblxuY3VycmVudGx5U2VsZWN0ZWRQbGFjZUVsZW1lbnQgPSBudWxsO1xuXG5zZWxlY3RlZEZyaWVuZHMgPSB7fTtcblxubWVhbHMgPSBbXG4gIHtcbiAgICBpZDogXCJjaGVlc2VidXJnZXJcIixcbiAgICB0aXRsZTogXCJDaGVlc2VidXJnZXJcIixcbiAgICB1cmw6IFwiaHR0cDovL25vZGVzY3J1bXB0aW91cy5henVyZXdlYnNpdGVzLm5ldC9tZWFscy9jaGVlc2VidXJnZXJcIlxuICB9LCB7XG4gICAgaWQ6IFwiY2hpbmVzZVwiLFxuICAgIHRpdGxlOiBcIkNoaW5lc2VcIixcbiAgICB1cmw6IFwiaHR0cDovL25vZGVzY3J1bXB0aW91cy5henVyZXdlYnNpdGVzLm5ldC9tZWFscy9jaGluZXNlXCJcbiAgfSwge1xuICAgIGlkOiBcImZyZW5jaFwiLFxuICAgIHRpdGxlOiBcIkZyZW5jaFwiLFxuICAgIHVybDogXCJodHRwOi8vbm9kZXNjcnVtcHRpb3VzLmF6dXJld2Vic2l0ZXMubmV0L21lYWxzL2ZyZW5jaFwiXG4gIH0sIHtcbiAgICBpZDogXCJob3Rkb2dcIixcbiAgICB0aXRsZTogXCJIb3QgRG9nXCIsXG4gICAgdXJsOiBcImh0dHA6Ly9ub2Rlc2NydW1wdGlvdXMuYXp1cmV3ZWJzaXRlcy5uZXQvbWVhbHMvaG90ZG9nXCJcbiAgfSwge1xuICAgIGlkOiBcImluZGlhblwiLFxuICAgIHRpdGxlOiBcIkluZGlhblwiLFxuICAgIHVybDogXCJodHRwOi8vbm9kZXNjcnVtcHRpb3VzLmF6dXJld2Vic2l0ZXMubmV0L21lYWxzL2luZGlhblwiXG4gIH0sIHtcbiAgICBpZDogXCJpdGFsaWFuXCIsXG4gICAgdGl0bGU6IFwiSXRhbGlhblwiLFxuICAgIHVybDogXCJodHRwOi8vbm9kZXNjcnVtcHRpb3VzLmF6dXJld2Vic2l0ZXMubmV0L21lYWxzL2l0YWxpYW5cIlxuICB9LCB7XG4gICAgaWQ6IFwicGl6emFcIixcbiAgICB0aXRsZTogXCJQaXp6YVwiLFxuICAgIHVybDogXCJodHRwOi8vbm9kZXNjcnVtcHRpb3VzLmF6dXJld2Vic2l0ZXMubmV0L21lYWxzL3BpenphXCJcbiAgfVxuXTtcblxubG9nUmVzcG9uc2UgPSBmdW5jdGlvbihyZXNwb25zZSkge1xuICBpZiAodHlwZW9mIGNvbnNvbGUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gY29uc29sZS5sb2coXCJUaGUgcmVzcG9uc2Ugd2FzXCIsIHJlc3BvbnNlKTtcbiAgfVxufTtcblxuaGFuZGxlU3RhdHVzQ2hhbmdlID0gZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgaWYgKHJlc3BvbnNlLmF1dGhSZXNwb25zZSkge1xuICAgIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IFwiI21lbnVcIjtcbiAgICByZXR1cm4gdXBkYXRlVXNlckluZm8ocmVzcG9uc2UpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24uaGFzaCA9IFwiI2xvZ2luXCI7XG4gIH1cbn07XG5cbnVwZGF0ZVVzZXJJbmZvID0gZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgcmV0dXJuIEZCLmFwaShcIi9tZVwiLCB7XG4gICAgZmllbGRzOiBcIm5hbWUsZmlyc3RfbmFtZSxwaWN0dXJlXCJcbiAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICB2YXIgb3V0cHV0O1xuICAgIGxvZ1Jlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICBvdXRwdXQgPSBcIlwiO1xuICAgIG91dHB1dCArPSBcIjxpbWcgc3JjPVxcXCJcIiArIHJlc3BvbnNlLnBpY3R1cmUuZGF0YS51cmwgKyBcIlxcXCIgd2lkdGg9XFxcIjI1XFxcIiBoZWlnaHQ9XFxcIjI1XFxcIj48L2ltZz5cIjtcbiAgICBvdXRwdXQgKz0gXCIgXCIgKyByZXNwb25zZS5maXJzdF9uYW1lO1xuICAgIHJldHVybiAkKFwiI3VzZXItaWRlbnRpdHlcIikuaHRtbChvdXRwdXQpO1xuICB9KTtcbn07XG5cbmhhbmRsZU9HU3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICBsb2dSZXNwb25zZShcIltoYW5kbGVPR1N1Y2Nlc3NdIGRvbmUuXCIpO1xuICBzaG93UHVibGlzaENvbmZpcm1hdGlvbigpO1xuICBzZWxlY3RlZE1lYWxJbmRleCA9IC0xO1xuICBzZWxlY3RlZFBsYWNlSW5kZXggPSAtMTtcbiAgc2VsZWN0ZWRQbGFjZUlEID0gbnVsbDtcbiAgY3VycmVudGx5U2VsZWN0ZWRQbGFjZUVsZW1lbnQgPSBudWxsO1xuICBzZWxlY3RlZEZyaWVuZHMgPSB7fTtcbiAgJChcIiNzZWxlY3QtbWVhbFwiKS5odG1sKFwiU2VsZWN0IG9uZVwiKTtcbiAgJChcIiNzZWxlY3QtbG9jYXRpb25cIikuaHRtbChcIlNlbGVjdCBvbmVcIik7XG4gICQoXCIjc2VsZWN0LWZyaWVuZHNcIikuaHRtbChcIlNlbGVjdCBmcmllbmRzXCIpO1xuICByZXR1cm4gJChcIiNhbm5vdW5jZVwiKS5hZGRDbGFzcyhcInVpLWRpc2FibGVkXCIpO1xufTtcblxuaGFuZGxlR2VuZXJpY0Vycm9yID0gZnVuY3Rpb24oZSkge1xuICByZXR1cm4gbG9nUmVzcG9uc2UoXCJFcnJvciAuLi5cIiArIEpTT04uc3RyaW5naWZ5KGUpKTtcbn07XG5cbmhhbmRsZVB1Ymxpc2hPR0Vycm9yID0gZnVuY3Rpb24oZSkge1xuICB2YXIgZXJyb3JDb2RlO1xuICBsb2dSZXNwb25zZShcIkVycm9yIHB1Ymxpc2hpbmcgLi4uXCIgKyBKU09OLnN0cmluZ2lmeShlKSk7XG4gIGVycm9yQ29kZSA9IGUuY29kZTtcbiAgbG9nUmVzcG9uc2UoXCJFcnJvciBjb2RlIC4uLlwiICsgZXJyb3JDb2RlKTtcbiAgaWYgKGVycm9yQ29kZSA9PT0gXCIyMDBcIikge1xuICAgIHJldHVybiByZWF1dGhvcml6ZUZvclB1Ymxpc2hQZXJtaXNzaW9ucygpO1xuICB9XG59O1xuXG5yZWF1dGhvcml6ZUZvclB1Ymxpc2hQZXJtaXNzaW9ucyA9IGZ1bmN0aW9uKCkge1xuICBsb2dSZXNwb25zZShcIltyZWF1dGhvcml6ZUZvclB1Ymxpc2hQZXJtaXNzaW9uc10gYXNraW5nIGZvciBhZGRpdGlvbmFsIHBlcm1pc3Npb25zLlwiKTtcbiAgcmV0dXJuIEZCLmxvZ2luKChmdW5jdGlvbihyZXNwb25zZSkge1xuICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgIHJldHVybiBoYW5kbGVHZW5lcmljRXJyb3IocmVzcG9uc2UuZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcHVibGlzaE9HQWN0aW9uKHJlc3BvbnNlKTtcbiAgICB9XG4gIH0pLCB7XG4gICAgc2NvcGU6IFwicHVibGlzaF9hY3Rpb25zXCJcbiAgfSk7XG59O1xuXG5wdWJsaXNoT0dBY3Rpb24gPSBmdW5jdGlvbihyZXNwb25zZSkge1xuICB2YXIgZXJyb3JIYW5kbGVyLCBmcmllbmRJREFycmF5cywgZnJpZW5kSWQsIHBhcmFtcztcbiAgZXJyb3JIYW5kbGVyID0gbnVsbDtcbiAgaWYgKCFyZXNwb25zZSB8fCByZXNwb25zZS5lcnJvcikge1xuICAgIGVycm9ySGFuZGxlciA9IGhhbmRsZVB1Ymxpc2hPR0Vycm9yO1xuICB9IGVsc2Uge1xuICAgIGVycm9ySGFuZGxlciA9IGhhbmRsZUdlbmVyaWNFcnJvcjtcbiAgfVxuICBsb2dSZXNwb25zZShcIlB1Ymxpc2hpbmcgYWN0aW9uLi4uXCIpO1xuICBwYXJhbXMgPSB7XG4gICAgbWVhbDogbWVhbHNbc2VsZWN0ZWRNZWFsSW5kZXhdLnVybFxuICB9O1xuICBpZiAoc2VsZWN0ZWRQbGFjZUlEKSB7XG4gICAgcGFyYW1zLnBsYWNlID0gc2VsZWN0ZWRQbGFjZUlEO1xuICB9XG4gIGZyaWVuZElEQXJyYXlzID0gW107XG4gIGZvciAoZnJpZW5kSWQgaW4gc2VsZWN0ZWRGcmllbmRzKSB7XG4gICAgaWYgKHNlbGVjdGVkRnJpZW5kcy5oYXNPd25Qcm9wZXJ0eShmcmllbmRJZCkpIHtcbiAgICAgIGZyaWVuZElEQXJyYXlzLnB1c2goZnJpZW5kSWQpO1xuICAgIH1cbiAgfVxuICBpZiAoZnJpZW5kSURBcnJheXMubGVuZ3RoID4gMCkge1xuICAgIHBhcmFtcy50YWdzID0gZnJpZW5kSURBcnJheXMuam9pbigpO1xuICB9XG4gIGxvZ1Jlc3BvbnNlKFwiUHVibGlzaCBwYXJhbXMgXCIgKyBKU09OLnN0cmluZ2lmeShwYXJhbXMpKTtcbiAgcmV0dXJuICQuYWpheCh7XG4gICAgdXJsOiBcIi9hbm5vdW5jZVwiLFxuICAgIHR5cGU6IFwicG9zdFwiLFxuICAgIGRhdGE6IHBhcmFtc1xuICB9KS5zdWNjZXNzKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgIHJldHVybiBoYW5kbGVPR1N1Y2Nlc3MocmVzdWx0KTtcbiAgfSkuZXJyb3IoZnVuY3Rpb24oeGhyKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJlc3BvbnNlID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgIGlmIChyZXNwb25zZS5lcnJvciAmJiByZXNwb25zZS5yZWRpcmVjdFVyaSkge1xuICAgICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uID0gcmVzcG9uc2UucmVkaXJlY3RVcmk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoX2Vycm9yKSB7fVxuICB9KTtcbn07XG5cbnNob3dQdWJsaXNoQ29uZmlybWF0aW9uID0gZnVuY3Rpb24oKSB7XG4gICQoXCIjY29uZmlybWF0aW9uXCIpLmFwcGVuZChcIjxwPlB1Ymxpc2ggc3VjY2Vzc2Z1bDwvcD5cIik7XG4gIHJldHVybiAkKFwiI2NvbmZpcm1hdGlvblwiKS5mYWRlT3V0KDMwMDAsIGZ1bmN0aW9uKCkge1xuICAgICQoXCIjY29uZmlybWF0aW9uXCIpLmh0bWwoXCJcIik7XG4gICAgcmV0dXJuICQoXCIjY29uZmlybWF0aW9uXCIpLnNob3coKTtcbiAgfSk7XG59O1xuXG5kaXNwbGF5TWVhbExpc3QgPSBmdW5jdGlvbigpIHtcbiAgdmFyIG91dHB1dCwgdG1wbDtcbiAgbG9nUmVzcG9uc2UoXCJbZGlzcGxheU1lYWxMaXN0XSBkaXNwbGF5aW5nIG1lYWwgbGlzdC5cIik7XG4gIHRtcGwgPSAkKFwiI21lYWxfbGlzdF90bXBsXCIpLmh0bWwoKTtcbiAgb3V0cHV0ID0gTXVzdGFjaGUudG9faHRtbCh0bXBsLCBtZWFscyk7XG4gIHJldHVybiAkKFwiI21lYWwtbGlzdFwiKS5odG1sKG91dHB1dCkubGlzdHZpZXcoXCJyZWZyZXNoXCIpO1xufTtcblxuZGlzcGxheVNlbGVjdGVkTWVhbCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgbWVhbCwgb3V0cHV0LCB0bXBsO1xuICBsb2dSZXNwb25zZShcIltkaXNwbGF5U2VsZWN0ZWRNZWFsXSBkaXNwbGF5aW5nIHNlbGVjdGVkIG1lYWwuXCIpO1xuICBtZWFsID0gbWVhbHNbc2VsZWN0ZWRNZWFsSW5kZXhdO1xuICB0bXBsID0gJChcIiNzZWxlY3RlZF9tZWFsX3RtcGxcIikuaHRtbCgpO1xuICBvdXRwdXQgPSBNdXN0YWNoZS50b19odG1sKHRtcGwsIG1lYWwpO1xuICByZXR1cm4gJChcIiNzZWxlY3RlZF9tZWFsXCIpLmh0bWwob3V0cHV0KTtcbn07XG5cbndpbmRvdy5nZXROZWFyYnkgPSBmdW5jdGlvbigpIHtcbiAgaWYgKG5lYXJieVBsYWNlcykge1xuICAgIHJldHVybjtcbiAgfVxuICBsb2dSZXNwb25zZShcIltnZXROZWFyYnldIGdldCBuZWFyYnkgZGF0YS5cIik7XG4gIHJldHVybiBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGZ1bmN0aW9uKGxvY2F0aW9uKSB7XG4gICAgbG9nUmVzcG9uc2UobG9jYXRpb24pO1xuICAgIHJldHVybiAkLmFqYXgoe1xuICAgICAgdXJsOiBcIi9zZWFyY2hcIixcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgdHlwZTogXCJwbGFjZVwiLFxuICAgICAgICBxOiBcInJlc3RhdXJhbnRcIixcbiAgICAgICAgY2VudGVyOiBsb2NhdGlvbi5jb29yZHMubGF0aXR1ZGUgKyBcIixcIiArIGxvY2F0aW9uLmNvb3Jkcy5sb25naXR1ZGUsXG4gICAgICAgIGRpc3RhbmNlOiAxMDAwLFxuICAgICAgICBmaWVsZHM6IFwiaWQsbmFtZSxwaWN0dXJlXCJcbiAgICAgIH1cbiAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICBuZWFyYnlQbGFjZXMgPSByZXNwb25zZS5kYXRhO1xuICAgICAgbG9nUmVzcG9uc2UobmVhcmJ5UGxhY2VzKTtcbiAgICAgIHJldHVybiBkaXNwbGF5UGxhY2VzKG5lYXJieVBsYWNlcyk7XG4gICAgfSkuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XG4gICAgICByZXR1cm4gbG9nUmVzcG9uc2UoXCJFcnJvciBmZXRjaGluZyBuZWFyYnkgcGxhY2UgZGF0YS5cIik7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZGlzcGxheVBsYWNlcyA9IGZ1bmN0aW9uKHBsYWNlcykge1xuICB2YXIgb3V0cHV0LCB0bXBsO1xuICBsb2dSZXNwb25zZShcIltkaXNwbGF5UGxhY2VzXSBkaXNwbGF5aW5nIG5lYXJieSBsaXN0LlwiKTtcbiAgdG1wbCA9ICQoXCIjcGxhY2VzX2xpc3RfdG1wbFwiKS5odG1sKCk7XG4gIG91dHB1dCA9IE11c3RhY2hlLnRvX2h0bWwodG1wbCwgcGxhY2VzKTtcbiAgcmV0dXJuICQoXCIjcGxhY2VzLWxpc3RcIikuaHRtbChvdXRwdXQpLmxpc3R2aWV3KFwicmVmcmVzaFwiKTtcbn07XG5cbndpbmRvdy5nZXRGcmllbmRzID0gZnVuY3Rpb24oKSB7XG4gIGlmIChteUZyaWVuZHMpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgbG9nUmVzcG9uc2UoXCJbZ2V0RnJpZW5kc10gZ2V0IGZyaWVuZCBkYXRhLlwiKTtcbiAgcmV0dXJuICQuYWpheCh7XG4gICAgdXJsOiBcIi9mcmllbmRzXCJcbiAgfSkuc3VjY2VzcyhmdW5jdGlvbihyZXNwb25zZSkge1xuICAgIG15RnJpZW5kcyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgbG9nUmVzcG9uc2UobXlGcmllbmRzKTtcbiAgICByZXR1cm4gZGlzcGxheUZyaWVuZHMobXlGcmllbmRzKTtcbiAgfSkuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XG4gICAgcmV0dXJuIGxvZ1Jlc3BvbnNlKFwiRXJyb3IgZmV0Y2hpbmcgZnJpZW5kIGRhdGEuXCIpO1xuICB9KTtcbn07XG5cbmRpc3BsYXlGcmllbmRzID0gZnVuY3Rpb24oZnJpZW5kcykge1xuICB2YXIgb3V0cHV0LCB0bXBsO1xuICBsb2dSZXNwb25zZShcIltkaXNwbGF5RnJpZW5kc10gZGlzcGxheWluZyBmcmllbmQgbGlzdC5cIik7XG4gIHRtcGwgPSAkKFwiI2ZyaWVuZHNfbGlzdF90bXBsXCIpLmh0bWwoKTtcbiAgb3V0cHV0ID0gTXVzdGFjaGUudG9faHRtbCh0bXBsLCBmcmllbmRzKTtcbiAgcmV0dXJuICQoXCIjZnJpZW5kcy1saXN0XCIpLmh0bWwob3V0cHV0KS5saXN0dmlldyhcInJlZnJlc2hcIik7XG59O1xuXG4kKGZ1bmN0aW9uKCkge1xuICAkKFwiI2xvZ291dFwiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICB3aW5kb3cubG9jYXRpb24gPSBcIi9sb2dvdXRcIjtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xuICAkKFwiI2Fubm91bmNlXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBwdWJsaXNoT0dBY3Rpb24obnVsbCk7XG4gIH0pO1xuICAkKFwiI21lYWwtbGlzdFwiKS5vbihcImNsaWNrXCIsIFwibGlcIiwgZnVuY3Rpb24oKSB7XG4gICAgc2VsZWN0ZWRNZWFsSW5kZXggPSAkKHRoaXMpLmluZGV4KCk7XG4gICAgbG9nUmVzcG9uc2UoXCJMaW5rIGluIG1lYWwgbGlzdHZpZXcgY2xpY2tlZC4uLiBcIiArIHNlbGVjdGVkTWVhbEluZGV4KTtcbiAgICByZXR1cm4gZGlzcGxheVNlbGVjdGVkTWVhbCgpO1xuICB9KTtcbiAgJChcIiNkZXRhaWwtbWVhbC1zZWxlY3RcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgJChcIiNhbm5vdW5jZVwiKS5yZW1vdmVDbGFzcyhcInVpLWRpc2FibGVkXCIpO1xuICAgIHJldHVybiAkKFwiI3NlbGVjdC1tZWFsXCIpLmh0bWwobWVhbHNbc2VsZWN0ZWRNZWFsSW5kZXhdLnRpdGxlKTtcbiAgfSk7XG4gICQoXCIjcGxhY2VzLWxpc3RcIikub24oXCJjbGlja1wiLCBcImxpXCIsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxlY3Rpb25JZCwgc2VsZWN0aW9uU3RhdHVzO1xuICAgIHNlbGVjdGlvbklkID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1uYW1lXCIpO1xuICAgIGxvZ1Jlc3BvbnNlKFwiU2VsZWN0ZWQgcGxhY2UgXCIgKyBzZWxlY3Rpb25JZCk7XG4gICAgc2VsZWN0aW9uU3RhdHVzID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1pY29uXCIpO1xuICAgIGlmIChzZWxlY3Rpb25TdGF0dXMgPT09IFwiZmFsc2VcIikge1xuICAgICAgaWYgKGN1cnJlbnRseVNlbGVjdGVkUGxhY2VFbGVtZW50KSB7XG4gICAgICAgIGN1cnJlbnRseVNlbGVjdGVkUGxhY2VFbGVtZW50LmJ1dHRvbk1hcmt1cCh7XG4gICAgICAgICAgaWNvbjogZmFsc2VcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICAkKHRoaXMpLmJ1dHRvbk1hcmt1cCh7XG4gICAgICAgIGljb246IFwiY2hlY2tcIlxuICAgICAgfSk7XG4gICAgICBzZWxlY3RlZFBsYWNlSUQgPSBzZWxlY3Rpb25JZDtcbiAgICAgIHNlbGVjdGVkUGxhY2VJbmRleCA9ICQodGhpcykuaW5kZXgoKTtcbiAgICAgICQoXCIjc2VsZWN0LWxvY2F0aW9uXCIpLmh0bWwobmVhcmJ5UGxhY2VzW3NlbGVjdGVkUGxhY2VJbmRleF0ubmFtZSk7XG4gICAgICByZXR1cm4gY3VycmVudGx5U2VsZWN0ZWRQbGFjZUVsZW1lbnQgPSAkKHRoaXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKHRoaXMpLmJ1dHRvbk1hcmt1cCh7XG4gICAgICAgIGljb246IGZhbHNlXG4gICAgICB9KTtcbiAgICAgIHNlbGVjdGVkUGxhY2VJRCA9IG51bGw7XG4gICAgICBzZWxlY3RlZFBsYWNlSW5kZXggPSAtMTtcbiAgICAgIHJldHVybiAkKFwiI3NlbGVjdC1sb2NhdGlvblwiKS5odG1sKFwiU2VsZWN0IG9uZVwiKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gJChcIiNmcmllbmRzLWxpc3RcIikub24oXCJjbGlja1wiLCBcImxpXCIsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBmcmllbmRJZCwgZnJpZW5kTmFtZUFycmF5LCBvdGhlckZyaWVuZHMsIHNlbGVjdGVkSW5kZXgsIHNlbGVjdGlvbklkLCBzZWxlY3Rpb25TdGF0dXM7XG4gICAgc2VsZWN0aW9uSWQgPSAkKHRoaXMpLmF0dHIoXCJkYXRhLW5hbWVcIik7XG4gICAgbG9nUmVzcG9uc2UoXCJTZWxlY3RlZCBmcmllbmQgXCIgKyBzZWxlY3Rpb25JZCk7XG4gICAgc2VsZWN0ZWRJbmRleCA9ICQodGhpcykuaW5kZXgoKTtcbiAgICBzZWxlY3Rpb25TdGF0dXMgPSAkKHRoaXMpLmF0dHIoXCJkYXRhLWljb25cIik7XG4gICAgaWYgKHNlbGVjdGlvblN0YXR1cyA9PT0gXCJmYWxzZVwiKSB7XG4gICAgICAkKHRoaXMpLmJ1dHRvbk1hcmt1cCh7XG4gICAgICAgIGljb246IFwiY2hlY2tcIlxuICAgICAgfSk7XG4gICAgICBzZWxlY3RlZEZyaWVuZHNbc2VsZWN0aW9uSWRdID0gbXlGcmllbmRzW3NlbGVjdGVkSW5kZXhdLm5hbWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICQodGhpcykuYnV0dG9uTWFya3VwKHtcbiAgICAgICAgaWNvbjogZmFsc2VcbiAgICAgIH0pO1xuICAgICAgZGVsZXRlIHNlbGVjdGVkRnJpZW5kc1tzZWxlY3Rpb25JZF07XG4gICAgfVxuICAgIGZyaWVuZE5hbWVBcnJheSA9IFtdO1xuICAgIGZvciAoZnJpZW5kSWQgaW4gc2VsZWN0ZWRGcmllbmRzKSB7XG4gICAgICBpZiAoc2VsZWN0ZWRGcmllbmRzLmhhc093blByb3BlcnR5KGZyaWVuZElkKSkge1xuICAgICAgICBmcmllbmROYW1lQXJyYXkucHVzaChzZWxlY3RlZEZyaWVuZHNbZnJpZW5kSWRdKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKGZyaWVuZE5hbWVBcnJheS5sZW5ndGggPiAyKSB7XG4gICAgICBvdGhlckZyaWVuZHMgPSBmcmllbmROYW1lQXJyYXkubGVuZ3RoIC0gMTtcbiAgICAgICQoXCIjc2VsZWN0LWZyaWVuZHNcIikuaHRtbChmcmllbmROYW1lQXJyYXlbMF0gKyBcIiBhbmQgXCIgKyBvdGhlckZyaWVuZHMgKyBcIiBvdGhlcnNcIik7XG4gICAgfSBlbHNlIGlmIChmcmllbmROYW1lQXJyYXkubGVuZ3RoID09PSAyKSB7XG4gICAgICAkKFwiI3NlbGVjdC1mcmllbmRzXCIpLmh0bWwoZnJpZW5kTmFtZUFycmF5WzBdICsgXCIgYW5kIFwiICsgZnJpZW5kTmFtZUFycmF5WzFdKTtcbiAgICB9IGVsc2UgaWYgKGZyaWVuZE5hbWVBcnJheS5sZW5ndGggPT09IDEpIHtcbiAgICAgICQoXCIjc2VsZWN0LWZyaWVuZHNcIikuaHRtbChmcmllbmROYW1lQXJyYXlbMF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKFwiI3NlbGVjdC1mcmllbmRzXCIpLmh0bWwoXCJTZWxlY3QgZnJpZW5kc1wiKTtcbiAgICB9XG4gICAgcmV0dXJuIGxvZ1Jlc3BvbnNlKFwiQ3VycmVudCBzZWxlY3QgZnJpZW5kcyBsaXN0OiBcIiArIHNlbGVjdGVkRnJpZW5kcyk7XG4gIH0pO1xufSk7XG5cbiQoZG9jdW1lbnQpLmRlbGVnYXRlKFwiI21lYWxzXCIsIFwicGFnZWluaXRcIiwgZnVuY3Rpb24oKSB7XG4gIHJldHVybiBkaXNwbGF5TWVhbExpc3QoKTtcbn0pO1xuXG4kKFwiYm9keVwiKS5iaW5kKFwiaGlkZU9wZW5NZW51c1wiLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuICQoXCJ1bDpqcW1EYXRhKHJvbGU9J21lbnUnKVwiKS5maW5kKFwibGkgPiB1bFwiKS5oaWRlKCk7XG59KTtcblxubWVudUhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XG4gICQoXCJib2R5XCIpLnRyaWdnZXIoXCJoaWRlT3Blbk1lbnVzXCIpO1xuICAkKHRoaXMpLmZpbmQoXCJsaSA+IHVsXCIpLnNob3coKTtcbiAgcmV0dXJuIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG59O1xuXG4kKFwidWw6anFtRGF0YShyb2xlPSdtZW51JykgbGkgPiB1bCBsaVwiKS5jbGljayhmdW5jdGlvbihlKSB7XG4gICQoXCJib2R5XCIpLnRyaWdnZXIoXCJoaWRlT3Blbk1lbnVzXCIpO1xuICByZXR1cm4gZS5zdG9wUHJvcGFnYXRpb24oKTtcbn0pO1xuXG4kKFwiYm9keVwiKS5kZWxlZ2F0ZShcInVsOmpxbURhdGEocm9sZT0nbWVudScpXCIsIFwiY2xpY2tcIiwgbWVudUhhbmRsZXIpO1xuXG4kKFwiYm9keVwiKS5jbGljayhmdW5jdGlvbihlKSB7XG4gIHJldHVybiAkKFwiYm9keVwiKS50cmlnZ2VyKFwiaGlkZU9wZW5NZW51c1wiKTtcbn0pO1xuIl19
